{% extends 'nguoi_dung/kt_base.html' %}

{% block content %}
<h2>Thêm thông tin khoản nộp</h2>

<form method="post" id="create-khoannop-form">
    {% csrf_token %}
    {{ form.as_p }}

    <div id="dien_tich">Diện tích: </div>
    <div id="so_nguoi">Số người: </div>

    <button type="submit" class="btn btn-primary">Lưu</button>
</form>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Khi người dùng chọn một căn hộ
        const hoGiaDinhField = document.getElementById('id_ho_gia_dinh');
        hoGiaDinhField.addEventListener('change', function () {
            const hoGiaDinhId = hoGiaDinhField.value;

            if (hoGiaDinhId) {
                fetch(`/get-hogiadinh-info/?ho_gia_dinh_id=${hoGiaDinhId}`)
                    .then(response => response.json())
                    .then(data => {
                        if (data.dien_tich && data.so_nguoi) {
                            // Cập nhật diện tích và số người
                            document.getElementById('dien_tich').innerText = `Diện tích: ${data.dien_tich} m²`;
                            document.getElementById('so_nguoi').innerText = `Số người: ${data.so_nguoi}`;
                        }
                    })
                    .catch(error => {
                        console.error('Có lỗi xảy ra:', error);
                    });
            }
        });
    });
</script>

{% endblock %}